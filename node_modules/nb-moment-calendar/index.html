<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>NB Moment Calendar playground</title>

    <!-- Bootstrap -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      <div class="container">
          <div class="row">
             <div class="col-md-12">
                 <h1>Moment Date Generator</h1>
                 <p>
                     <a href="https://github.com/joelchu/moment-date-generator">Github</a>
                </p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div id="calendar"></div>
            </div>
			<div class="col-md-3">
				<p>
					<button class="btn btn-success" id="showYear">SHOW YEAR</button>
				</p>
				<p>
					<button class="btn btn-primary" id="showTwoMonths">SHOW TWO MONTHS</button>
				</p>
			</div>
            <div class="col-md-3">
                <div id="months"></div>
            </div>
        </div>
    </div>

	<script src="bower_components/moment/min/moment-with-locales.min.js"></script>
	<script src="bower_components/lodash/lodash.min.js"></script>
	<script src="bower_components/immutable/dist/immutable.js"></script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src="./dist/nb-moment-calendar.umd.js"></script>
    <script>

		var NBCal = new NBMomentCalendar.default({logger: console.log});
		var mom = NBCal.getMoment();
        var currentYear = mom().format('YYYY');
		var current = mom([currentYear , 11]);
		var generateCalTpl = function(month)
		{
			var ctn = month.length;
			var tpl = '<table class="table">';
				tpl += '<tbody>';
			for (var i=0; i<ctn; ++i) {
				tpl += '<tr>';
				for (var j in month[i]) {
					var m = month[i][j];
					tpl += '<td class="';
					if (m.pad) {
						tpl += 'text-muted';
					}
					else {
						tpl += 'info';
					}
					tpl += '">';
					tpl += m.day;
					tpl += '</td>';
				}
				tpl += '</tr>';
			}
				tpl += '</tbody></table>';
			return tpl;
		};

		var newMonth = function(year , month)
		{
			var month = NBCal.getMonth(currentYear , month);
			$('#calendar').html(generateCalTpl(month));
			return false;
		};
		/**
		 * onLoaded
		 */
		$(function()
		{
			var monthDiv = $('#months');
			for (var i=0; i<12; ++i) {
				var j = i+1;
				var btn = '<p><button class="btn btn-info" id="#2015-'+ (j) +'">' + currentYear + ' - '+ (j) +'</button></p>';
				var el = $(btn).appendTo(monthDiv);

				$(el.find('button')).on('click' , function()
				{
					var id = $(this).attr('id');
					var parts = id.replace('#' ,'').split('-');
					console.log(parts);
					return newMonth(parts[0] , parts[1]);
				});
			}
			/////////////////////////////
			//		EXAMPLE ONE        //
			/////////////////////////////

			var month = NBCal.getMonth(currentYear , 12);
			$('#calendar').append(generateCalTpl(month));

			////////////////////////////
			// 		EXAMPLE GET YEAR  //
			////////////////////////////

			$('#showYear').on('click' , function(e)
			{
				e.preventDefault();
				$('#calendar').html('');
				var year = NBCal.getYear(currentYear);
				for (var i=0; i<year.length; ++i) {
					var cal = '<p><h4>' + year[i].heading + '</h4>';
						cal += generateCalTpl(year[i].data);
						cal += '</p>';

					$('#calendar').append(cal);
				}
			});

			$('#showTwoMonths').on('click' , function(e)
			{
				e.preventDefault();
				$('#calendar').html('');
				var months = NBCal.getMonths(currentYear , 12 , 2 , 'MMMM YY');
				console.log(months);
				for (var i=0; i<months.length; ++i) {
					var cal = '<p><h4>' + months[i].heading + '</h4>';
						cal += generateCalTpl(months[i].data);
						cal += '</p>';

					$('#calendar').append(cal);
				}
			});

		});

    </script>
</body>
</html>
