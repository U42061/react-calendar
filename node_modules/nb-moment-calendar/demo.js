'use strict';

const moment = require('moment');
const _ = require('lodash');
const Immutable = require('immutable');

const Table = require('cli-table');
// grab a instance
const NBMomentCalendar = require('./dist/nb-moment-calendar.umd.js');

// console.log(NBMomentCalendar.default);

const ginstance = new NBMomentCalendar.default({logger: console.log});

// console.log(  ginstance );

/**
 * grab three months worth of data and take a look at it.
 */
const m = moment();

const thisMonth = m.format('M');
const thisYear  = m.format('YYYY');

const lm = m.clone().subtract(1 , 'month');
const lastMonth = lm.format('M');
const lastYear  = lm.format('YYYY');

const nm = m.clone().add(1 , 'month');
const nextMonth = nm.format('M');
const nextYear  = nm.format('YYYY');

const months = [];
const monthHeading = [
	{y: lastYear , m: lastMonth},
	{y: thisYear , m: thisMonth},
	{y: nextYear , m: nextMonth}
];


months.push(ginstance.getMonth(lastYear , lastMonth));
months.push(ginstance.getMonth(thisYear , thisMonth));
months.push(ginstance.getMonth(nextYear , nextMonth));

const conf = ginstance.getConfig();

for (let i=0; i<months.length; ++i) {

	const tbl = new Table({
		head: conf.localeConfig.weekdaysMin
	});

	const month = months[i];
	// console.log(month);

	for (let j=0; j< month.length; ++j) {
		const rows = [];
		//for (const k=0; k<month[j].length; ++k) {
		for (const k in month[j]) {
			const item = month[j][k].day;
			rows.push(item);
		}
		tbl.push(rows);
	}
	console.log([monthHeading[i].y , monthHeading[i].m].join(' - '));
	console.log(tbl.toString());
}
